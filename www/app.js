(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i={voteItem:{padding:"30px",cursor:"pointer"}},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.voteDown=function(){console.log("clicked down"),n.setState({selected:"down"}),n.submit()},n.voteUp=function(){console.log("clicked up"),n.setState({selected:"up"}),n.submit()},n.resetInput=function(){n.setState({selected:!1})},n.submit=function(){var e=n.props,t=e.send,r=e.artworkID;t({type:"vote",payload:n.state.selected,id:r})&&n.resetInput()},n.state={selected:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){var e=this.props.feedback,t=this.state.selected;return a.default.createElement(o.Block,{id:"vote"},a.default.createElement("h2",null,e.instructions),a.default.createElement(o.Block,null,a.default.createElement("span",{onClick:this.voteDown,style:{marginRight:"20px"}},a.default.createElement(o.Icon,{id:"down",style:i.voteItem,fa:"thumbs-down",size:"200",tooltip:"Dislike",color:"down"===t?"red":"blue"})),a.default.createElement("span",{onClick:this.voteUp,style:{marginLeft:"20px"}},a.default.createElement(o.Icon,{id:"up",style:i.voteItem,fa:"thumbs-up",tooltip:"Like",size:"200",color:"up"===t?"red":"blue"}))),a.default.createElement("div",null,"Clicking the thumbs will submit your answer to the artist"))}}]),t}();t.default=l},101:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.props,t=e.send,r=e.artworkID;t({type:"likert",payload:n.state.selectedOption,id:r})&&n.resetInput()},n.enableSubmitBtn=function(e){n.setState({selectedOption:e.target.value})},n.resetInput=function(){n.setState({selectedOption:null})},n.state={selectedOption:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){var e=this.props.feedback,t=this.state.selectedOption;return a.default.createElement(o.Block,null,a.default.createElement("h2",null,e.instructions),a.default.createElement("p",null,e.content),a.default.createElement(o.BlockTitle,null,"Choose one answer"),a.default.createElement(o.List,null,a.default.createElement(o.ListItem,{onChange:this.enableSubmitBtn,radio:!0,required:!0,value:"auction",title:"Auction it",name:"choice"}),a.default.createElement(o.ListItem,{onChange:this.enableSubmitBtn,radio:!0,required:!0,value:"fair",title:"Sell it at a fair or convention",name:"choice"}),a.default.createElement(o.ListItem,{onChange:this.enableSubmitBtn,radio:!0,required:!0,value:"gallery",title:"Exhibit it at an art gallery",name:"choice"}),a.default.createElement(o.ListItem,{onChange:this.enableSubmitBtn,radio:!0,required:!0,value:"print",title:"Print posters and postcards",name:"choice"}),a.default.createElement(o.ListItem,{onChange:this.enableSubmitBtn,radio:!0,required:!0,value:"keep",title:"Keep it",name:"choice"})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:!t,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your answer to the artist"))}}]),t}();t.default=i},102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));var a={navCenterMsg:{textAlign:"center",align:"center",margin:"auto",paddingLeft:"50px",fontWeight:"bold"}};t.default=function(e){return r.default.createElement("div",{style:a.navCenterMsg},e.msg)}},103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),a=n(14);t.default=function(){return r.default.createElement(a.Page,null,r.default.createElement(a.Navbar,{title:"About",backLink:"Back"}),r.default.createElement(a.BlockTitle,null,"About My App"),r.default.createElement(a.Block,{strong:!0},r.default.createElement("p",null,"Here is About page!"),r.default.createElement("p",null,"You can go ",r.default.createElement(a.Link,{back:!0},"back"),"."),r.default.createElement("p",null,"Mauris posuere sit amet metus id venenatis. Ut ante dolor, tempor nec commodo rutrum, varius at sem. Nullam ac nisi non neque ornare pretium. Nulla mauris mauris, consequat et elementum sit amet, egestas sed orci. In hac habitasse platea dictumst."),r.default.createElement("p",null,"Fusce eros lectus, accumsan eget mi vel, iaculis tincidunt felis. Nulla tincidunt pharetra sagittis. Fusce in felis eros. Nulla sit amet aliquam lorem, et gravida ipsum. Mauris consectetur nisl non sollicitudin tristique. Praesent vitae metus ac quam rhoncus mattis vel et nisi. Aenean aliquet, felis quis dignissim iaculis, lectus quam tincidunt ligula, et venenatis turpis risus sed lorem. Morbi eu metus elit. Ut vel diam dolor.")))}},104:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),a=n(14);t.default=function(){return r.default.createElement(a.Page,null,r.default.createElement(a.Navbar,{title:"Not found",backLink:"Back"}),r.default.createElement(a.Block,{strong:!0},r.default.createElement("p",null,"Sorry"),r.default.createElement("p",null,"Requested content not found.")))}},105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(2)),o=n(14),i=l(n(106));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={contactaddress:"U2FsdGVkX1/JrJqNqbD5sIVnYfrksOefEbBPzqBmEv1lnCIGyRMM0EOgq+mSGJCC"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"componentDidMount",value:function(){var e=i.default.AES.decrypt(this.state.contactaddress,"8723ikhgjsKJDH*&#IU#JR#(UFDJSDG337hgea").toString(i.default.enc.Utf8);this.setState({contactaddress:e})}},{key:"render",value:function(){var e=this.state.contactaddress;return a.default.createElement(o.Popup,{id:"popup",tabletFullscreen:!1},a.default.createElement(o.View,null,a.default.createElement(o.Page,null,a.default.createElement(o.Navbar,{title:"About"},a.default.createElement(o.NavRight,null,a.default.createElement(o.Link,{popupClose:!0},a.default.createElement(o.Icon,{f7:"close"})))),a.default.createElement(o.Block,null,a.default.createElement(o.BlockTitle,null,"View artworks and provide feedback!"),a.default.createElement(o.Block,null,"An art installation by researchers from the Center for Ubiquitous Computing, University of Oulu"),a.default.createElement(o.BlockTitle,null,"How it works"),a.default.createElement(o.Block,null,"We invited artists to showcase their artworks in this installation. One artwork is showing on the main screen in front of you. Each artwork is accompanied with a way for you to provide feedback, as chosen by the respective artist.",a.default.createElement("br",null),"All submitted feedback is sent to the respective artists."),a.default.createElement(o.BlockTitle,null,"Privacy Policy"),a.default.createElement(o.Block,null,"Your data will be shared with the artist who uploaded the artwork to this installation. Besides the researchers and the artist, nobody else will have access to your submitted data.",a.default.createElement("br",null),"For further question, contact ",e,".")))))}}]),t}();t.default=u},132:function(e,t,n){},136:function(e,t,n){},54:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),a=n(14);t.default=function(e){return r.default.createElement(a.Block,null,r.default.createElement(a.Button,{onClick:e.onCaptureClick,outline:!0,big:!0},r.default.createElement(a.Icon,{f7:e.icon})," ",e.buttonText))}},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaRecorderOptions=function(){var e={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(e.mimeType)||(console.error(e.mimeType+" is not Supported"),e={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(e.mimeType)||(console.error(e.mimeType+" is not Supported"),e={mimeType:"video/webm"},MediaRecorder.isTypeSupported(e.mimeType)||(console.error(e.mimeType+" is not Supported"),e={mimeType:""})));return e}},68:function(e,t,n){e.exports=n(69)},69:function(e,t,n){"use strict";var r=c(n(2)),a=c(n(72)),o=c(n(140)),i=c(n(14));n(80);var l=c(n(81));n(130),n(132),n(134),n(136),n(138);var u=n(139);function c(e){return e&&e.__esModule?e:{default:e}}o.default.use(i.default);var s=function(){var e=document.getElementById("app");a.default.render(r.default.createElement(u.AppContainer,null,r.default.createElement(l.default,null)),e)};window.cordova?document.addEventListener("deviceready",function(){var e=cordova.plugins.permissions,t=[e.CAMERA,e.RECORD_AUDIO];e.checkPermission(t,function(n){n.hasPermission?(console.log("Permission already granted. Starting react."),s()):e.requestPermissions(t,function(e){console.log("Permission granted. Starting react."),s()},function(){console.warn("Camera and/or Audio permission is not turned on")})},function(){console.warn("Camera and/or Audio permission is not turned on")})},!1):s()},81:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={id:"com.perdis.prototype",name:"PerDis Prototype",theme:"auto",fastClicks:!0,routes:o.default,data:function(){return{SERVER:"ubistudies.com",PORT:"8000",CONTACT_EMAIL:"U2FsdGVkX19mfX61lfutSWMU/RswHMXhcF/8yUMUeXxLJYLjByso6IvDmy2NjlSg",SECRETKEY:"8723ikhgjsKJDH*&#IU#JR#(UFDJSDG337hgea"}}};return r.default.createElement(a.App,{params:t},r.default.createElement(a.Statusbar,null),r.default.createElement(a.View,{id:"main-view",url:"/",main:!0,className:"ios-edges"}),r.default.createElement(i.default,{id:"popup"}))};var r=l(n(2)),a=n(14),o=l(n(82)),i=l(n(105));function l(e){return e&&e.__esModule?e:{default:e}}},82:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(83)),a=i(n(103)),o=i(n(104));function i(e){return e&&e.__esModule?e:{default:e}}t.default=[{path:"/",component:r.default},{path:"/about/",component:a.default},{path:"(.*)",component:o.default}]},83:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(2)),o=(u(n(84)),n(14)),i=u(n(85)),l=u(n(102));function u(e){return e&&e.__esModule?e:{default:e}}var c=1e3,s={imgstyle:{maxWidth:"50px",maxHeight:"50px",marginRight:"10px",border:"1px solid #FFFFFF"},submitButton:{textTransform:"uppercase"},navLoader:{marginRight:"10px"},feedback:{textAlign:"center",align:"center"},textCenter:{textAlign:"center"}},d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.connectWebSocket=function(){var e=n.$f7.data,t=e.SERVER,r=e.PORT,a=n;n.mySocket=new WebSocket("ws://"+t+":"+r+"/"),n.mySocket.onopen=function(e){console.info("WS: WebSocket connection established"),!0===a.state.connectionError&&a.setState({connectionError:!1}),console.info("WS: syncing initial"),this.send("sync")},n.mySocket.onmessage=function(e){var t=JSON.parse(e.data);console.log("WS: received: ",t),this.setState({artwork:t.artwork,feedback:t.feedback,infoOnlyFeedback:"dummy"===t.feedback.type})}.bind(n),n.mySocket.onerror=function(e){var t=this;console.error("WS: WebSocket connection error:",e),this.setState({connectionError:!0}),setTimeout(function(){t.connectWebSocket()},c)}.bind(n)},n.updateNavCenterMsg=function(e){n.setState({navCenterMsg:e})},n.getImageAspectRatio=function(e){var t=e.target;n.setState({aspectRatio:t.offsetWidth/t.offsetHeight})},n.mySocket=null,n.state={artwork:null,feedback:null,connectionError:!1,navCenterMsg:"",infoOnlyFeedback:!1,aspectRatio:1},n.refresh=n.refresh.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"componentWillMount",value:function(){this.connectWebSocket()}},{key:"componentWillUnmount",value:function(){this.mySocket&&this.mySocket.close()}},{key:"refresh",value:function(e){return this.mySocket?(console.log("Sending feedback:",e),e="dummy"===e.type?"sync":JSON.stringify(e),this.mySocket.send(e),this.setState({artwork:null,feedback:null}),!0):(console.error("Can't send feedback - no WebSocket connection"),!1)}},{key:"render",value:function(){var e=this.state,t=e.artwork,n=e.feedback,r=e.aspectRatio,u=e.connectionError,c=e.navCenterMsg,d=e.infoOnlyFeedback,f=this.$f7.data,p=f.SERVER,m=f.PORT;return console.log(t,n,r),a.default.createElement(o.Page,{style:{backgroundColor:d?"#ffeb3b":"inherit"}},a.default.createElement(o.Navbar,{sliding:!0},a.default.createElement(o.NavLeft,null,a.default.createElement(o.Link,{popupOpen:"#popup"},a.default.createElement(o.Icon,{f7:"help_round"}))),a.default.createElement(o.NavTitle,{title:"Provide your feedback!"}),c&&a.default.createElement(l.default,{msg:c}),!d&&a.default.createElement(o.NavRight,null,t&&t.thumb?a.default.createElement("img",{alt:"",onLoad:this.getImageAspectRatio,src:t.thumb,style:s.imgstyle}):a.default.createElement(o.Preloader,{style:s.navLoader,size:42}))),!d&&a.default.createElement("div",null,t&&!d?a.default.createElement(o.Block,{style:s.textCenter},a.default.createElement("h1",null,'"',t.title,'" ',a.default.createElement("span",{style:{fontWeight:"normal"}},"by")," ",t.artist)):a.default.createElement(o.Block,{style:s.textCenter},a.default.createElement(o.Preloader,{style:s.navLoader,size:42}))),a.default.createElement(o.Block,{style:s.feedback},a.default.createElement(i.default,{feedback:n,artwork:t,send:this.refresh,updateNavCenterMsg:this.updateNavCenterMsg,aspectRatio:r})),u&&a.default.createElement(o.Block,{style:s.textCenter},a.default.createElement(o.BlockTitle,null,"WEBSOCKET CONNECTION ERROR"),a.default.createElement("p",null,"Could not connect to ws://",p,":",m)))}}]),t}();t.default=d},85:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=b(n(2)),a=b(n(86)),o=b(n(87)),i=b(n(89)),l=b(n(93)),u=b(n(94)),c=b(n(95)),s=b(n(96)),d=b(n(97)),f=b(n(98)),p=b(n(99)),m=b(n(100)),h=b(n(101));function b(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.feedback,n=e.artwork,b=e.aspectRatio,v=e.updateNavCenterMsg,y=e.send;if(!t||!t.type||!n)return null;console.log("FeedbackFactory:",t.type),console.log("aspectRatio",b);var g=n.id;switch(t.type){case"dummy":return r.default.createElement(l.default,{artworkID:g,feedback:t,send:y});case"consent":return r.default.createElement(u.default,{artworkID:g,feedback:t,send:y});case"imagetimer":return r.default.createElement(o.default,{artworkID:g,feedback:t,send:y,updateNavCenterMsg:v});case"image":return r.default.createElement(a.default,{artworkID:g,feedback:t,send:y});case"video":return r.default.createElement(i.default,{artworkID:g,feedback:t,send:y});case"reaction":return r.default.createElement(c.default,{artworkID:g,feedback:t,send:y});case"visual":return r.default.createElement(s.default,{artworkID:g,feedback:t,send:y,artwork:n,aspectRatio:b});case"question":return r.default.createElement(d.default,{artworkID:g,feedback:t,send:y});case"answer":return r.default.createElement(f.default,{artworkID:g,feedback:t,send:y});case"likert":return r.default.createElement(p.default,{artworkID:g,feedback:t,send:y});case"multiplechoice":return r.default.createElement(h.default,{artworkID:g,feedback:t,send:y});case"vote":return r.default.createElement(m.default,{artworkID:g,feedback:t,send:y})}return console.error("unknown feedback.type",t.type),null}},86:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(2)),o=n(14),i=l(n(54));function l(e){return e&&e.__esModule?e:{default:e}}var u={video:{width:"auto",maxWidth:"100%",maxHeight:"640px",border:"3px solid red",backgroundColor:"#303030"},img:{width:"auto",maxWidth:"100%",maxHeight:"640px",border:"3px solid #303030",backgroundColor:"#303030"},center:{textAlign:"center"}},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){console.log("submitting feedback");var e=n.props;(0,e.send)({type:"image",id:e.artworkID,payload:n.state.image})&&n.resetCapture()},n.onCaptureClick=function(){var e=n.videoRef.current,t=n.canvasRef.current;t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height);var r=t.toDataURL("image/jpeg");n.setState({image:r,submitBtnDisabled:!1,isRecording:!1,selfieCaptured:!0})},n.onResetButtonClick=function(){n.resetCapture(),n.activateWebStream(),n.setState({isRecording:!0})},n.resetCapture=function(){var e=n.canvasRef.current;e.getContext("2d").clearRect(0,0,e.width,e.height),n.setState({image:null,submitBtnDisabled:!0,isRecording:!0,selfieCaptured:!1})},n.state={submitBtnDisabled:!0,errorMsg:null,image:null,artworkID:!1,isRecording:!0,selfieCaptured:!1},n.videoRef=a.default.createRef(),n.canvasRef=a.default.createRef(),n.activateWebStream=n.activateWebStream.bind(n),n.handleStreamSuccess=n.handleStreamSuccess.bind(n),n.handleStreamError=n.handleStreamError.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"activateWebStream",value:function(){console.log("activateWebStream");navigator.mediaDevices.getUserMedia({audio:!1,video:{width:720,height:1280}}).then(this.handleStreamSuccess).catch(this.handleStreamError)}},{key:"handleStreamSuccess",value:function(e){var t=this.videoRef.current;try{t.srcObject=e}catch(n){t.src=window.URL.createObjectURL(e)}}},{key:"handleStreamError",value:function(e){console.error("navigator.getUserMedia error [%s]: ",e.code,e.name,e.message);var t=e.name;"NotSupportedError"==e.name&&(t="Browser Not Supported"),this.setState({errorMsg:t+": "+e.message})}},{key:"componentWillReceiveProps",value:function(e){console.info("componentWillReceiveProps","new:",e.artworkID,"old:",this.state.artworkID),e.artworkID!==this.state.artworkID&&(this.setState({artworkID:e.artworkID}),this.activateWebStream())}},{key:"componentDidMount",value:function(){this.activateWebStream()}},{key:"render",value:function(){var e=this.state,t=e.submitBtnDisabled,n=e.errorMsg,r=(e.image,e.isRecording),l=e.selfieCaptured,c=this.props.feedback;return a.default.createElement(o.Block,{id:"webcam-video"},a.default.createElement("h2",null,c.instructions),a.default.createElement("div",{style:{display:n?"block":"none"},id:"errorMsg"},n),a.default.createElement("div",{style:{display:r?"block":"none"}},a.default.createElement("video",{id:"video",ref:this.videoRef,style:u.video,autoPlay:"autoplay",playsInline:!0})),a.default.createElement("div",{style:{display:l?"block":"none"}},a.default.createElement("canvas",{id:"canvas",ref:this.canvasRef,style:u.img})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"20"}),a.default.createElement(o.Col,{width:"60"},r&&a.default.createElement(i.default,{buttonText:"Take Picture",icon:"camera_round",onCaptureClick:this.onCaptureClick}),l&&a.default.createElement(i.default,{buttonText:"Reset Picture",icon:"delete_round",onCaptureClick:this.onResetButtonClick})),a.default.createElement(o.Col,{width:"20"})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"20"}),a.default.createElement(o.Col,{width:"60"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:t,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"20"})),a.default.createElement("div",null,"Clicking this button will submit your image to the artist"))}}]),t}();t.default=c},87:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(2)),o=n(14),i=u(n(54)),l=u(n(88));function u(e){return e&&e.__esModule?e:{default:e}}var c={video:{width:"auto",maxWidth:"100%",maxHeight:"640px",border:"3px solid red",backgroundColor:"#303030"},img:{width:"auto",maxWidth:"100%",maxHeight:"640px",border:"3px solid #303030",backgroundColor:"#303030"},center:{textAlign:"center"}},s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){console.log("submitting feedback");var e=n.props;(0,e.send)({type:"image",id:e.artworkID,payload:n.state.image})&&n.resetCapture()},n.startTimer=function(){n.activateWebStream()},n.capture=function(){var e=n.videoRef.current,t=n.canvasRef.current;t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height);var r=t.toDataURL("image/jpeg");n.resetVideo(),n.setState({image:r,submitBtnDisabled:!1,isRecording:!1,selfieCaptured:!0,timerRunning:!1})},n.onResetButtonClick=function(){n.resetCapture()},n.resetCapture=function(){n.resetVideo();var e=n.canvasRef.current;e.getContext("2d").clearRect(0,0,e.width,e.height),n.setState({image:null,submitBtnDisabled:!0,isRecording:!1,selfieCaptured:!1,timerRunning:!1})},n.resetVideo=function(){if(console.log("Reset video"),n.stream)for(var e=n.stream.getTracks(),t=0;t<e.length;t++)e[t].stop(),console.log("Stopped track",t);n.stream=null;var r=n.videoRef.current;r.removeAttribute("src"),r.removeAttribute("srcObject")},n.state={submitBtnDisabled:!0,errorMsg:null,image:null,artworkID:!1,isRecording:!1,selfieCaptured:!1,timerRunning:!1},n.videoRef=a.default.createRef(),n.canvasRef=a.default.createRef(),n.activateWebStream=n.activateWebStream.bind(n),n.handleStreamSuccess=n.handleStreamSuccess.bind(n),n.handleStreamError=n.handleStreamError.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"activateWebStream",value:function(){console.log("activateWebStream");navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(this.handleStreamSuccess).catch(this.handleStreamError)}},{key:"handleStreamSuccess",value:function(e){this.stream=e,this.setState({timerRunning:!0});var t=this.videoRef.current;try{t.srcObject=this.stream}catch(e){t.src=window.URL.createObjectURL(this.stream)}}},{key:"handleStreamError",value:function(e){console.error("navigator.getUserMedia error [%s]: ",e.code,e.name,e.message);var t=e.name;"NotSupportedError"==e.name&&(t="Browser Not Supported"),this.setState({errorMsg:t+": "+e.message})}},{key:"componentWillReceiveProps",value:function(e){console.info("componentWillReceiveProps","new:",e.artworkID,"old:",this.state.artworkID),e.artworkID!==this.state.artworkID&&this.setState({artworkID:e.artworkID})}},{key:"render",value:function(){var e=this.state,t=e.submitBtnDisabled,n=e.errorMsg,r=e.image,u=(e.isRecording,e.selfieCaptured),s=e.timerRunning,d=this.props,f=d.feedback,p=d.updateNavCenterMsg;return a.default.createElement(o.Block,{id:"webcam-video"},a.default.createElement("h2",null,f.instructions),a.default.createElement("div",{style:{display:n?"block":"none"},id:"errorMsg"},n),a.default.createElement("div",{style:{display:s?"block":"none"}},a.default.createElement("video",{id:"video",ref:this.videoRef,style:c.video,autoPlay:"autoplay",playsInline:!0})),a.default.createElement("div",{style:{display:u?"block":"none"}},a.default.createElement("canvas",{id:"canvas",ref:this.canvasRef,style:c.img})),s&&a.default.createElement(l.default,{action:this.capture,isRunning:s,updateNavCenterMsg:p}),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"20"}),a.default.createElement(o.Col,{width:"60"},!s&&!r&&a.default.createElement(i.default,{buttonText:"Take Picture",icon:"camera_round",onCaptureClick:this.startTimer}),u&&a.default.createElement(i.default,{buttonText:"Reset Picture",icon:"delete_round",onCaptureClick:this.onResetButtonClick})),a.default.createElement(o.Col,{width:"20"})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"20"}),a.default.createElement(o.Col,{width:"60"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:t,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"20"})),a.default.createElement("div",null,"Clicking this button will submit your image to the artist"))}}]),t}();t.default=s},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2));n(14);var o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.intervalTimer=null,n.RunActionAndReset=n.RunActionAndReset.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"reset",value:function(){this.setState({txt:"Ready?"})}},{key:"RunActionAndReset",value:function(){var e=this.props,t=e.action,n=e.updateNavCenterMsg;clearInterval(this.intervalTimer),n(""),t()}},{key:"componentDidMount",value:function(){var e=3,t=this.props.updateNavCenterMsg;t("Ready?");var n=this;this.intervalTimer=setInterval(function(){0==e?n.RunActionAndReset():t(e),e-=1},1e3)}},{key:"render",value:function(){return null}}]),t}();t.default=o},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=s(n(2)),o=n(14),i=s(n(90)),l=n(56),u=n(57),c=n(92);function s(e){return e&&e.__esModule?e:{default:e}}var d={audio:!1,video:{facingMode:"user",width:720,height:1280}},f=function(){return a.default.createElement("span",null,a.default.createElement(o.Icon,{fa:"dot-circle"})," Start Recording")},p=function(){return a.default.createElement("span",null,a.default.createElement(o.Icon,{fa:"stop-circle"})," Stop Recording")},m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e={type:"video",id:n.props.artworkID},t=new Blob(n.recordedBlobs,{type:"video/webm"});l.Device.android?window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,function(r){var a=Math.round((new Date).getTime()/1e3),o="video-"+(0,i.default)()+"-"+a+".webm";r.getFile(o,{create:!0,exclusive:!1},function(r){(0,c.writeFile)(r,t),e.payload=r,n.sendFeedback(e)},n.onErrorCreateFile)},n.onErrorLoadFs):(e.payload=t,n.sendFeedback(e))},n.sendFeedback=function(e){(0,n.props.send)(e)&&n.resetVideo()},n.recordedBlobs=[],n.mediaSource=new MediaSource,n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen,!1),n.mediaRecorder,n.sourceBuffer,n.stream,n.state={buttonTxt:a.default.createElement(f,null),buttonAction:n.start,submitBtnDisabled:!0,artworkID:!1,isRecording:!1,isPlaying:!1},n.videoRef=a.default.createRef(),n.recordedRef=a.default.createRef(),n.activateStream=n.activateStream.bind(n),n.handleGetUserMediaSuccess=n.handleGetUserMediaSuccess.bind(n),n.handleGetUserMediaError=n.handleGetUserMediaError.bind(n),n.start=n.start.bind(n),n.stop=n.stop.bind(n),n.play=n.play.bind(n),n.handleDataAvailable=n.handleDataAvailable.bind(n),n.handleSourceOpen=n.handleSourceOpen.bind(n),n.state.buttonAction=n.state.buttonAction.bind(n),n.enableSubmitBtn=n.enableSubmitBtn.bind(n),n.resetVideo=n.resetVideo.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"onErrorLoadFs",value:function(e){console.error("onErrorLoadFs",e)}},{key:"onErrorCreateFile",value:function(e){console.error("onErrorCreateFile",e)}},{key:"enableSubmitBtn",value:function(){this.setState({submitBtnDisabled:!1})}},{key:"resetVideo",value:function(){this.stream=null,this.recordedBlobs=[],this.sourceBuffer=null;var e=this.videoRef.current;e.src=null,e.srcObject=null;var t=this.recordedRef.current;t.src=null,t.srcObject=null,this.setState({isRecording:!1,isPlaying:!1})}},{key:"handleSourceOpen",value:function(e){console.log("MediaSource opened");var t=(0,u.getMediaRecorderOptions)();this.sourceBuffer=this.mediaSource.addSourceBuffer(t),console.log("Source buffer: ",this.sourceBuffer)}},{key:"componentWillReceiveProps",value:function(e){console.info("componentWillReceiveProps"),this.state.artworkID&&e.artworkID===this.state.artworkID||(this.setState({artworkID:e.artworkID}),this.activateStream())}},{key:"activateStream",value:function(){console.log("activateStream"),navigator.mediaDevices.getUserMedia(d).then(this.handleGetUserMediaSuccess).catch(this.handleGetUserMediaError)}},{key:"handleGetUserMediaSuccess",value:function(e){console.log("getUserMedia() got stream:",e),this.stream=e;var t=this.videoRef.current;t.controls=!1;try{t.srcObject=e}catch(n){t.src=window.URL.createObjectURL(e)}}},{key:"handleGetUserMediaError",value:function(e){console.error("navigator.getUserMedia error: ",e),this.setState({isRecording:!1,isPlaying:!1})}},{key:"handleDataAvailable",value:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)}},{key:"start",value:function(){var e=(0,u.getMediaRecorderOptions)();this.recordedBlobs=[];try{this.mediaRecorder=new MediaRecorder(this.stream,e)}catch(e){return void console.error("Exception while creating MediaRecorder:",e)}console.log("Created MediaRecorder",this.mediaRecorder,"with options",e),this.mediaRecorder.onstop=function(e){console.log("Recorder stopped: ",e)},this.mediaRecorder.ondataavailable=this.handleDataAvailable,this.mediaRecorder.start(10),console.log("MediaRecorder started",this.mediaRecorder),this.setState({buttonTxt:a.default.createElement(p,null),buttonAction:this.stop,isRecording:!0,isPlaying:!1})}},{key:"stop",value:function(){this.mediaRecorder.stop(),this.setState({buttonTxt:a.default.createElement(f,null),buttonAction:this.start,isRecording:!1,isPlaying:!1}),this.play(),this.enableSubmitBtn()}},{key:"play",value:function(){var e=this.recordedRef.current,t=new Blob(this.recordedBlobs,{type:"video/webm"});e.src=null,e.srcObject=null;try{e.srcObject=t}catch(n){e.src=window.URL.createObjectURL(t)}e.onloadedmetadata=function(t){console.log("video loaded",t),e.controls=!0,this.setState({isPlaying:!0}),e.play()}.bind(this)}},{key:"componentDidMount",value:function(){this.activateStream()}},{key:"render",value:function(){var e=this.state,t=e.isRecording,n=e.isPlaying,r=this.props.feedback;return a.default.createElement(o.Block,{id:"webcam-video"},a.default.createElement("h2",null,r.instructions),a.default.createElement(o.Block,{style:{display:t?"block":"none"}},a.default.createElement("video",{id:"video",ref:this.videoRef,style:{maxHeight:"640px",width:"auto",maxWidth:"100%",border:t?"3px solid red":"3px solid #303030",backgroundColor:"#303030"},playsInline:!0,autoPlay:!0,muted:!0})),a.default.createElement(o.Block,{style:{display:n?"block":"none"}},a.default.createElement("video",{id:"recorded",ref:this.recordedRef,style:{maxHeight:"640px",width:"auto",maxWidth:"100%",border:"1px solid #000000",backgroundColor:"#303030"},playsInline:!0,autoPlay:!0,loop:!0,muted:!0})),a.default.createElement("div",{id:"errorMsg"}),a.default.createElement(o.Block,null,a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{outline:!0,big:!0,onClick:this.state.buttonAction},this.state.buttonTxt)),a.default.createElement(o.Col,{width:"33"}))),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit,disabled:this.state.submitBtnDisabled},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your video to the artist"))}}]),t}();t.default=m},92:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeFile=function(e,t){if(!t)return;e.createWriter(function(n){n.onwriteend=function(){console.log("Successfully written:",e)},n.onerror=function(e){console.log("Failed file write: "+e.toString())},n.write(t)})}},93:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),l=0;l<a;l++)o[l]=arguments[l];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.submit=function(){(0,r.props.send)({type:"dummy",payload:{}})},i(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.PureComponent),r(t,[{key:"render",value:function(){var e=this.props.feedback;return a.default.createElement(o.Block,null,a.default.createElement("h2",null,e.instructions),a.default.createElement("p",null,e.content),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit},"Start Over")),a.default.createElement(o.Col,{width:"33"})))}}]),t}();t.default=l},94:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),l=0;l<a;l++)o[l]=arguments[l];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.submit=function(){(0,r.props.send)({type:"next",payload:{}})},i(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.PureComponent),r(t,[{key:"render",value:function(){var e=this.props.feedback;return a.default.createElement(o.Block,null,a.default.createElement("h2",null,e.instructions),a.default.createElement("p",null,e.content),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"25"}),a.default.createElement(o.Col,{width:"25"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit},"Cancel")),a.default.createElement(o.Col,{width:"25"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit},"I Consent")),a.default.createElement(o.Col,{width:"25"})))}}]),t}();t.default=l},95:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14),i=(n(56),n(57));var l={video:{width:"auto",maxWidth:"100%",maxHeight:"250px",border:"3px solid #303030",backgroundColor:"#303030"}},u={audio:!1,video:{facingMode:"user",width:1280,height:720}},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.props,t=e.send,r={type:"reaction",id:e.artworkID},a=(0,i.getMediaRecorderOptions)(),o=new Blob(n.recordedBlobs,a);r.payload=o,t(r)&&(n.resetVideo(),n.setState({artworkID:!1}))},n.skip=function(){var e=n.props,t=e.send,r={type:"reaction",id:e.artworkID,payload:"skip"};t(r)&&(n.resetVideo(),n.setState({artworkID:!1}))},n.recordedBlobs=[],n.mediaSource=new MediaSource,n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen,!1),n.mediaRecorder,n.sourceBuffer,n.stream,n.state={submitBtnDisabled:!0,videoVisible:!1,artworkID:e.artworkID},n.recordedRef=a.default.createRef(),n.activateStream=n.activateStream.bind(n),n.handleStreamSuccess=n.handleStreamSuccess.bind(n),n.handleStreamError=n.handleStreamError.bind(n),n.resetVideo=n.resetVideo.bind(n),n.playBack=n.playBack.bind(n),n.stop=n.stop.bind(n),n.startTimer=n.startTimer.bind(n),n.startBuffer=n.startBuffer.bind(n),n.handleDataAvailable=n.handleDataAvailable.bind(n),n.handleSourceOpen=n.handleSourceOpen.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){console.info("componentWillReceiveProps","new:",e.artworkID,"old:",this.state.artworkID),this.state.artworkID&&e.artworkID===this.state.artworkID||(this.setState({artworkID:e.artworkID}),this.activateStream())}},{key:"startTimer",value:function(){var e=this;setTimeout(function(){console.log("this.mediaRecorder",e.mediaRecorder),e.mediaRecorder.stop();for(var t=e.stream.getTracks(),n=0;n<t.length;n++)t[n].stop();e.setState({videoVisible:!0,submitBtnDisabled:!1}),e.playBack()},1e4)}},{key:"handleSourceOpen",value:function(e){console.log("MediaSource opened"),this.sourceBuffer=this.mediaSource.addSourceBuffer('video/webm; codecs="vp8"'),console.log("Source buffer: ",this.sourceBuffer)}},{key:"resetVideo",value:function(){this.stream=null,this.recordedBlobs=[],this.sourceBuffer=null;var e=this.recordedRef.current;e.srcObject=null,e.src=null,e.removeAttribute("srcObject"),e.removeAttribute("src"),e.load(),e.controls=!1,this.setState({videoVisible:!1})}},{key:"activateStream",value:function(){navigator.mediaDevices.getUserMedia(u).then(this.handleStreamSuccess).catch(this.handleStreamError)}},{key:"handleStreamSuccess",value:function(e){console.log("getUserMedia() got stream:",e),this.stream=e,this.startBuffer(),this.startTimer()}},{key:"handleStreamError",value:function(e){console.error("navigator.getUserMedia error: ",e),console.log(e.code,e.name,e.message)}},{key:"handleDataAvailable",value:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)}},{key:"startBuffer",value:function(){this.recordedRef.current;var e=(0,i.getMediaRecorderOptions)();try{this.mediaRecorder=new MediaRecorder(this.stream,e)}catch(e){return void console.error("Exception while creating MediaRecorder:",e)}console.log("Created MediaRecorder",this.mediaRecorder,"with options",e),this.mediaRecorder.onstop=function(e){console.log("Recorder stopped: ",e)},this.mediaRecorder.ondataavailable=this.handleDataAvailable,this.mediaRecorder.start(10),console.log("MediaRecorder started",this.mediaRecorder)}},{key:"playBack",value:function(){var e=this.recordedRef.current,t=new Blob(this.recordedBlobs,{type:"video/webm"});console.log("this.stream",this.stream),e.src=null,e.srcObject=null;try{e.srcObject=t}catch(n){e.src=window.URL.createObjectURL(t)}e.onloadedmetadata=function(t){console.log("video loaded",t),e.controls=!0,e.play()}}},{key:"stop",value:function(){}},{key:"componentDidMount",value:function(){this.activateStream()}},{key:"render",value:function(){var e=this.state.videoVisible;return a.default.createElement(o.Block,{id:"webcam-video"},a.default.createElement(o.Block,{style:{display:e?"block":"none"}},a.default.createElement("video",{style:l.video,id:"recorded",ref:this.recordedRef,muted:!0,loop:!0,autoplay:!0})),a.default.createElement("div",{id:"errorMsg"}),a.default.createElement(o.Block,{style:{margin:"10em 0",display:e?"none":"block"}},a.default.createElement("h1",null,"Look at the artwork!"),a.default.createElement(o.Preloader,{color:"black",size:"50"})),a.default.createElement(o.Block,{style:{display:e?"block":"none"}},a.default.createElement("h1",null,"We recorded your reaction to this artwork."),a.default.createElement("h2",null,"Submit the reaction to the artist?")),a.default.createElement(o.Block,{style:{display:e?"block":"none"}},a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"20"}),a.default.createElement(o.Col,{width:"30"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit,disabled:this.state.submitBtnDisabled},"Submit")),a.default.createElement(o.Col,{width:"30"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.skip},"Skip")),a.default.createElement(o.Col,{width:"20"})),a.default.createElement("div",null,"Clicking the submit button will submit your video to the artist."),a.default.createElement("div",null,'Clicking "skip" will delete the video.')))}}]),t}();t.default=c},96:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i={canvas:{border:"1px solid #000000",margin:0,padding:0},sketchpadapp:{WebkitTouchCallout:"none",WebkitUserSelect:"none",khtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"},sketchpad:{WebkitTouchCallout:"none",WebkitUserSelect:"none",khtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",border:"2px solid #888",borderRadius:"4px",position:"relative"}},l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.props;(0,e.send)({type:"image",id:e.artworkID,payload:n.state.touchStack})&&n.clearCanvas()},n.init=function(){n.canvas=n.canvasRef.current,n.canvas.getContext&&(n.ctx=n.canvas.getContext("2d")),n.ctx&&(n.clearCanvas(),n.canvas.addEventListener("mousedown",n.sketchpad_mouseDown,!1),n.canvas.addEventListener("mousemove",n.sketchpad_mouseMove,!1),window.addEventListener("mouseup",n.sketchpad_mouseUp,!1),n.canvas.addEventListener("touchstart",n.sketchpad_touchStart,!1),n.canvas.addEventListener("touchmove",n.sketchpad_touchMove,!1))},n.canvasRef=a.default.createRef(),n.state={touchStack:[],artworkSrc:null},n.ctx=null,n.canvas=null,n.mouseX,n.mouseY,n.mouseDown=0,n.touchX,n.touchY,n.clearCanvas=n.clearCanvas.bind(n),n.sketchpad_mouseDown=n.sketchpad_mouseDown.bind(n),n.sketchpad_mouseUp=n.sketchpad_mouseUp.bind(n),n.sketchpad_mouseMove=n.sketchpad_mouseMove.bind(n),n.drawDot=n.drawDot.bind(n),n.getMousePos=n.getMousePos.bind(n),n.sketchpad_touchStart=n.sketchpad_touchStart.bind(n),n.sketchpad_touchMove=n.sketchpad_touchMove.bind(n),n.getTouchPos=n.getTouchPos.bind(n),n.loadImage=n.loadImage.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.setState({touchStack:[],artworkSrc:null}),this.loadImage()}},{key:"drawDot",value:function(e,t){this.ctx.fillStyle="rgba(255,255,0,1)",this.ctx.beginPath(),this.ctx.arc(e,t,12,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()}},{key:"sketchpad_mouseDown",value:function(){var e=this.state.touchStack;this.mouseDown=1;var t=(new Date).getTime();this.drawDot(this.mouseX,this.mouseY),e.push([this.mouseX,this.mouseY,t]),this.setState({touchStack:e})}},{key:"sketchpad_mouseUp",value:function(){this.mouseDown=0}},{key:"sketchpad_mouseMove",value:function(e){var t=this.state.touchStack;if(this.getMousePos(e),1==this.mouseDown){var n=(new Date).getTime();this.drawDot(this.mouseX,this.mouseY),t.push([this.mouseX,this.mouseY,n]),this.setState({touchStack:t})}}},{key:"getMousePos",value:function(e){if(!e)event;e.offsetX?(this.mouseX=e.offsetX,this.mouseY=e.offsetY):e.layerX&&(this.mouseX=e.layerX,this.mouseY=e.layerY)}},{key:"sketchpad_touchStart",value:function(e){var t=this.state.touchStack;this.getTouchPos(e),this.drawDot(this.touchX,this.touchY);var n=(new Date).getTime();t.push([this.touchX,this.touchY,n]),this.setState({touchStack:t}),e.preventDefault()}},{key:"sketchpad_touchMove",value:function(e){var t=this.state.touchStack;this.getTouchPos(e);var n=(new Date).getTime();this.drawDot(this.touchX,this.touchY),t.push([this.touchX,this.touchY,n]),this.setState({touchStack:t}),e.preventDefault()}},{key:"getTouchPos",value:function(e){if(e.touches&&1==e.touches.length){var t=e.touches[0],n=this.canvasRef.current.getBoundingClientRect();this.touchX=t.pageX-n.left,this.touchY=t.pageY-n.top}}},{key:"loadImage",value:function(){console.log("loadImage");var e=this.props,t=e.artwork,n=(e.aspectRatio,new Image);n.onload=function(){console.info("imageObj.onload"),this.ctx.drawImage(n,0,0,this.canvas.width,this.canvas.height)}.bind(this),n.src=t.src}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentDidUpdate",value:function(e,t){this.state.touchStack.length||this.loadImage()}},{key:"componentWillUnmount",value:function(){this.ctx=null,this.canvas=null,this.mouseX=null,this.mouseY=null,this.mouseDown=0,this.touchX=null,this.touchY=null}},{key:"render",value:function(){console.log("renderVISUAL");var e=this.state,t=e.touchStack,n=void 0===t?[]:t,r=(e.imgSrc,this.props),l=(r.artwork,r.feedback),u=480/r.aspectRatio;return a.default.createElement(o.Block,{id:"touch"},a.default.createElement("h2",null,l.instructions),a.default.createElement(o.Block,{style:i.sketchpadapp},a.default.createElement("canvas",{width:480,height:u,style:i.sketchpad,ref:this.canvasRef})),a.default.createElement(o.Block,null,a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{outline:!0,big:!0,onClick:this.clearCanvas,disabled:0===n.length},a.default.createElement(o.Icon,{md:"f7:undo",style:{paddingRight:"0.5em"}})," Undo")),a.default.createElement(o.Col,{width:"33"}))),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:0===n.length,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your feedback to the artist"))}}]),t}();t.default=l},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.props,t=e.send,r=e.artworkID;t({type:"question",payload:n.state.question,id:r})&&n.resetInput()},n.resetInput=function(){n.setState({question:"",submitBtnDisabled:!0})},n.enableSubmitBtn=function(e){var t=e.target.value;t?n.setState({submitBtnDisabled:!1,question:t}):n.setState({submitBtnDisabled:!0,question:""})},n.state={submitBtnDisabled:!0,question:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){var e=this.state,t=e.question,n=e.submitBtnDisabled,r=this.props.feedback;return a.default.createElement(o.Block,null,a.default.createElement("h2",null,r.instructions),a.default.createElement(o.List,{noHairlines:!0},a.default.createElement(o.Input,{id:"question",type:"text",onChange:this.enableSubmitBtn,onInputClear:this.resetInput,placeholder:"Enter your question here",clearButton:!0,value:t})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:n,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your answer to the artist"))}}]),t}();t.default=i},98:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.resetInput=function(){n.setState({answer:"",submitBtnDisabled:!0})},n.enableSubmitBtn=function(e){console.log("e.target.value",e.target.value),e.target.value?n.setState({submitBtnDisabled:!1,answer:e.target.value}):n.setState({submitBtnDisabled:!0,answer:""})},n.state={submitBtnDisabled:!0,answer:""},n.submit=n.submit.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"submit",value:function(){var e=this.props,t=e.send,n=e.artworkID;t({type:"answer",payload:this.state.answer,id:n})&&this.resetInput()}},{key:"render",value:function(){var e=this.state,t=e.answer,n=e.submitBtnDisabled,r=this.props.feedback;return console.log("feedback.inputtype",r.inputtype),a.default.createElement(o.Block,null,a.default.createElement("h2",null,r.instructions),a.default.createElement("p",null,r.content),a.default.createElement(o.List,{noHairlines:!0},a.default.createElement(o.Input,{id:"question",type:r.inputtype,clearButton:!0,placeholder:"Enter your answer here",onChange:this.enableSubmitBtn,onInputClear:this.resetInput,value:t})),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,disabled:n,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your answer to the artist"))}}]),t}();t.default=i},99:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(14);var i={leftDescr:{textAlign:"right"},rightDescr:{textAlign:"left"}},l={min:1,max:5,step:1};l.initial=(l.max-l.min)/2+1;var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.submit=function(){var e=n.props,t=e.send,r=e.artworkID;t({type:"likert",payload:n.state.sliderValue,id:r})&&n.setState({sliderValue:l.initial})},n.handleSliderChange=function(e){console.log("Slider changed to %s",e),n.setState({sliderValue:e})},n.state={selectedOption:null,sliderValue:l.initial},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){var e=this.props.feedback,t=this.state,n=(t.selectedOption,t.sliderValue);return a.default.createElement(o.Block,null,a.default.createElement("h2",null,e.instructions),a.default.createElement("p",null,e.content),a.default.createElement(o.BlockTitle,null,"Choose your answer"),a.default.createElement(o.Block,null,a.default.createElement(o.Row,null,a.default.createElement(o.Col,{style:i.leftDescr,width:"15"},"Strongly Disagree (",l.min,")"),a.default.createElement(o.Col,{width:"70"},a.default.createElement(o.Range,{label:!0,draggableBar:!0,onRangeChanged:this.handleSliderChange,min:l.min,max:l.max,step:l.step,value:n})),a.default.createElement(o.Col,{style:i.rightDescr,width:"15"},"Strongly Agree (",l.max,")"))),a.default.createElement(o.Row,null,a.default.createElement(o.Col,{width:"33"}),a.default.createElement(o.Col,{width:"33"},a.default.createElement(o.Button,{fill:!0,big:!0,onClick:this.submit},"Submit")),a.default.createElement(o.Col,{width:"33"})),a.default.createElement("div",null,"Clicking this button will submit your answer to the artist"))}}]),t}();t.default=u}},[[68,2,1]]]);